<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>게시글 수정</title>
    <link rel="stylesheet" href="boardstyle.css" />
</head>

<body>
    <header>
        <a href="home.html">
            <img src="img/mainLg2.png" alt="메인 로고">
        </a>
        <ul>
            <li><a href="#">학습하기</a></li>
            <li><a href="#">퀴즈풀기</a></li>
            <li><a href="#">출석하기</a></li>
            <li><a href="#">포인트 상점</a></li>
            <li><a href="faq.html">FAQ</a></li>
            <li><a href="#">공지사항</a></li>
        </ul>
    </header>

    <main>
        <a href="index.html" class="list-button">📋 게시글 목록</a>
        <h1>게시글 수정</h1>
        <form id="edit-form">
            <input type="text" id="title" placeholder="제목" required />
            <textarea id="content" placeholder="내용" rows="10" required></textarea>
            <input type="text" id="videoUrl" placeholder="YouTube 영상 URL (선택)" />
            <button type="submit">수정 완료</button>
        </form>
    </main>

    <div id="footer">
        <ul>
            <li>대표전화: 042-222-2402</li>
            <li>주소: (34838) 대전 중구 중앙로121번길 20(방산빌딩 3층)</li>
            <li>운영시간: 평일 09:00 ~ 18:00 (주말·공휴일 휴무)</li>
            <li>© 2025 역사 한 걸음. All rights reserved.</li>
        </ul>
    </div>

    <script src="board.js"></script>
    <script>
        const params = new URLSearchParams(window.location.search);
        const id = Number(params.get('id'));
        const posts = getPosts();
        const post = posts.find(p => p.id === id);

        if (!post) {
            document.body.innerHTML = '<p>존재하지 않는 글입니다.</p>';
        } else {
            document.getElementById('title').value = post.title;
            document.getElementById('content').value = post.content;
            document.getElementById('videoUrl').value = post.videoUrl || '';
        }

        document.getElementById('edit-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const updatedPost = {
                id: post.id,
                title: document.getElementById('title').value.trim(),
                content: document.getElementById('content').value.trim(),
                date: post.date,
                videoUrl: document.getElementById('videoUrl').value.trim(),
                videoId: extractYoutubeId(document.getElementById('videoUrl').value.trim())
            };

            const newPosts = posts.map(p => p.id === post.id ? updatedPost : p);
            localStorage.setItem('posts', JSON.stringify(newPosts));

            alert('수정이 완료되었습니다.');
            window.location.href = `view.html?id=${post.id}`;
        });
    </script>
</body>

</html>