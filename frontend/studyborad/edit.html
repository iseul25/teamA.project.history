<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>ê²Œì‹œê¸€ ìˆ˜ì •</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <a href="mainindex.html" class="back-button">ë©”ì¸í™”ë©´</a>
    <main>
        <a href="index.html" class="list-button">ğŸ“‹ ê²Œì‹œê¸€ ëª©ë¡</a>
        <h1>ê²Œì‹œê¸€ ìˆ˜ì •</h1>
        <form id="edit-form">
            <input type="text" id="title" placeholder="ì œëª©" required />
            <input type="text" id="author" placeholder="ì‘ì„±ì" required />
            <textarea id="content" placeholder="ë‚´ìš©" rows="10" required></textarea>
            <input type="text" id="videoUrl" placeholder="YouTube ì˜ìƒ URL (ì„ íƒ)" />
            <button type="submit">ìˆ˜ì • ì™„ë£Œ</button>
        </form>
    </main>

    <script src="board.js"></script>
    <script>
        const params = new URLSearchParams(window.location.search);
        const id = Number(params.get('id'));
        const posts = getPosts();
        const post = posts.find(p => p.id === id);

        if (!post) {
            document.body.innerHTML = '<p>ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸€ì…ë‹ˆë‹¤.</p>';
        } else {
            document.getElementById('title').value = post.title;
            document.getElementById('author').value = post.author;
            document.getElementById('content').value = post.content;
            document.getElementById('videoUrl').value = post.videoUrl || '';
        }

        document.getElementById('edit-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const updatedPost = {
                id: post.id, // ê¸°ì¡´ id ìœ ì§€
                title: document.getElementById('title').value.trim(),
                author: document.getElementById('author').value.trim(),
                content: document.getElementById('content').value.trim(),
                date: post.date, // ê¸°ì¡´ ë‚ ì§œ ìœ ì§€
                videoUrl: document.getElementById('videoUrl').value.trim(),
                videoId: extractYoutubeId(document.getElementById('videoUrl').value.trim())
            };

            const newPosts = posts.map(p => p.id === post.id ? updatedPost : p);
            localStorage.setItem('posts', JSON.stringify(newPosts));

            alert('ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            window.location.href = `view.html?id=${post.id}`;
        });
    </script>
</body>

</html>