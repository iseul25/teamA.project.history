쿼리구문 예시(숫자 및 ''안의 단어는 예시입니다. -- 및 /* */ 안의 항목은 설명용이라 실제 구문에 반영되지 않습니다.)


-- quizId 1의 정답을 선택지 3으로 지정
UPDATE quiz
SET answer = 3
WHERE quizId = 1;

-- quizId 2, 3의 정답을 선택지 2로 지정
UPDATE quiz
SET answer = 2
WHERE quizId IN (2, 3);

-- quiz의 selectedItem 항목과 answer 항목이 같으면 10점, 다르면 0점을 quizScore  항목에 기입
UPDATE quiz
SET quizScore = CASE
    WHEN selectedItem = answer THEN 10
    ELSE 0
END;
    
-- 2번 유저의 quizScore를 모두 합산해 totalScore에 기입
UPDATE quiz
SET totalScore = (
    SELECT SUM(quizScore)
    FROM quiz
    WHERE userId = 2
)
WHERE userId = 2;
    
/* 2번, 3번, 5번 유저를 대상으로 totalScore의 0.1배로 earnedPoint 기입*/
UPDATE quiz
SET earnedPoint = totalScore * 0.1
WHERE userId IN (2, 3, 5);


/*points 테이블에 상점이용 생성*/
INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (2, NULL, 1, NULL);

INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (3, NULL, 2, NULL);

INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (5, NULL, 3, NULL);

/*상점이용에 따른 포인트 차감*/
UPDATE points pt
SET pointChange = - (SELECT cost FROM point_shop WHERE itemId = pt.itemId)
WHERE pt.itemId IS NOT NULL
  AND pt.attendanceId IS NULL
  AND pt.scoreId IS NULL;
  
  
/* points 테이블에 출석체크 생성*/
INSERT INTO point_transactions (userId, attendanceId, itemId, quizId) 
VALUES (2, 918, NULL, NULL);

INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (3, 919, NULL, NULL);

INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (5, 920, NULL, NULL);

/*출석체크에 따른 포인트 적립*/
UPDATE points pt
SET pointChange = (SELECT pointAdd FROM user_attendance WHERE attendanceId = pt.attendanceId)
WHERE pt.attendanceId IS NOT NULL
  AND pt.itemId IS NULL
  AND pt.scoreId IS NULL;
  
  
/* points 테이블에 퀴즈응시 생성*/
INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (2, NULL, NULL, 7);

INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (3, NULL, NULL, 8);

INSERT INTO points (userId, attendanceId, itemId, quizId) 
VALUES (5, NULL, NULL, 9);

/*퀴즈응시에 따른 포인트 적립*/
UPDATE points pt
SET pointChange = (SELECT pointScore FROM quiz WHERE quizId = pt.quizId)
WHERE pt.scoreId IS NOT NULL
  AND pt.itemId IS NULL
  AND pt.attendanceId IS NULL;
